---
layout:     post
title:      "Линейная регрессия в R."
date:       2015-09-25 12:00:00
author:     "Vasiliy Zemlyanov"
header-img: "img/post-bg-03.jpg"
---
#Линейная регрессия
`Линейная регрессия` — метод восстановления зависимости между переменными.
Для одной свободной модель имеет вид:

`yi = Theta0 + Theta1*xi`

, где
`yi` - зависимая переменная для *i*-го наблюдения;
`xi` - независимая переменная для i*-го наблюдения;
`Thate0` - *свободный** коэффициент;
`Thate1` - регрессионный коэффициент для зависимой переменной.

Для нескольких свободных переменных:

`y = Theta0 + Theta1*x1 + Theta2*x2 + ... + Thetan*xn`

Стоит учитывать что модель вида:

`y = Theta0 + Theta1*x1^2 + Theta2*x2*x1`

и тому подобные так-же будут являеться линейной регрессией.

Более подробно о том как работает методи линейной регресси и зачем он нужен можно узнать:
`Вставить ссылки на информацию по линейной регресси.`
А в данной статье рассмотрим применение метода линейной регрессии в R.

#Линейная регессия в R
Для примера воспользуемся данными стоимости вина Бордо и попробуем самостоятельно предсказать его стоимость.

Загрузим данные и рассмотрим что у нас есть.

{% highlight R %}
#  Читаем данные из .csv файла
>wine <- read.csv('wine.csv')

#  Общая информация о данных
>str(wine)
>summary(wine)
{% endhighlight %}

Построим модель линейной регрессии от одной переменной. Для этого функции `lm()` (linear model) передаются в качестве параметров формула и набор данных.
Формула имеет вид `y ~ x1 + x2 + x3`, где `y` зависимая переменная, `x1, x2, x3` *А КАК НАЗЫВАЕТСЯ Х?*

{% highlight R %}
#  Строим линейную регрессию от одной переменной
>wineReg <- lm(Price ~ Age)

# Рассмотрим полученную модель
>summary(wineReg)
{% endhighlight %}


#Определение качества линйеной регрессии
Качество линейной регрессии можно определить следующий образом:
`SSE` - Suf of Squared Errors. Сумма квадратов между предасказанными моделью значениям и реальными значениями зависимой переменной.

`Формула`
`Картинка`

`SST` - Sum of Squares Total. Базовая модель, в которой не используются переменные. То же что `SSE`, только вместо предсказаний модели используется среднее арифметическое зависимой переменной.

`Формула`
`Картинка`

`R2` - сравниваем модель с базовой моделью. 

`R2 = 1 - SSE/SST`

Чем выше `R2` тем лучше полученная модель.
`R2 = 0` никакого улучшения по сравнению с базовой моделью.
`R2 = 1` отлично предсказывающая модель.

Не все доступные переменные стоит использовать. Перегрузка модели может привести к `overfitting`, когда модель будет показывать идеальные результаты на тестовых данных и будет абсолютно неприменима к реальным данным.